<%- include('../partials/header', {title: 'Audit Logs'}) %>

<div class="grid grid-cols-1 min-h-screen lg:grid-cols-5">
  <%- include('../partials/sidebar') %>
  <main class="col-span-1 p-4 sm:p-6 lg:col-span-4 lg:p-8 relative">
    
    <header class="flex items-center justify-between border-b-2 border-black pb-6">
        <h1 class="text-4xl font-extrabold uppercase">Audit Logs</h1>
    </header>

    <section class="mt-8 overflow-x-auto border-2 border-black shadow-md">
      <table class="w-full">
        <thead class="bg-black text-white">
          <tr>
            <th class="p-3 text-left uppercase text-sm">Time</th>
            <th class="p-3 text-left uppercase text-sm">Actor</th>
            <th class="p-3 text-left uppercase text-sm">Action</th>
            <th class="p-3 text-left uppercase text-sm">Target</th>
            <th class="p-3 text-left uppercase text-sm">Details</th>
          </tr>
        </thead>
        <tbody class="text-sm font-mono">
          <% if (logs.length === 0) { %>
            <tr>
              <td colspan="5" class="p-8 text-center text-neutral-500 uppercase font-bold">No logs recorded yet.</td>
            </tr>
          <% } %>
          
          <% logs.forEach(log => { %>
          <tr class="border-b border-neutral-300 hover:bg-neutral-100 transition-colors">
            <td class="p-3 whitespace-nowrap text-xs text-neutral-600">
                <%= new Date(log.created_at).toLocaleString() %>
            </td>
            
            <td class="p-3 font-bold text-blue-800">
                <%= log.actor_name || 'System' %>
            </td>
            
            <td class="p-3">
                <span class="border border-neutral-400 bg-white px-1 text-xs uppercase tracking-wide">
                    <%= log.action %>
                </span>
            </td>
            
            <td class="p-3 text-xs">
                <span class="font-bold"><%= log.entity_type %></span>: 
                <%= log.entity_id ? log.entity_id.substring(0,8)+'...' : '-' %>
            </td>
            
            <td class="p-3 text-xs text-neutral-600 max-w-xs overflow-hidden text-ellipsis whitespace-nowrap" title="<%= JSON.stringify(log.details, null, 2) %>">
                <%= JSON.stringify(log.details) %>
            </td>
          </tr>
          <% }) %>
        </tbody>
      </table>
    </section>
  </main>
</div>
<%- include('../partials/footer') %>
