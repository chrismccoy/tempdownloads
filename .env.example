# ==============================================================================
# üì¶ TEMP DOWNLOADS - ENVIRONMENT CONFIGURATION
# ==============================================================================
# Copy this file to .env and update the values for your environment.
#
# ‚ö†Ô∏è  CRITICAL SECURITY NOTE:
# Never commit your actual .env file to version control.
# Ensure ENCRYPTION_KEYS and SESSION_SECRET are generated securely in production.
# ==============================================================================

# --- APPLICATION BASICS ---
# NODE_ENV: 'development' (verbose errors) or 'production' (json logs, secure cookies)
NODE_ENV=development

# PORT: The HTTP port the server listens on.
PORT=3000

# APP_URL: The public-facing URL. Used for generating download links.
# Example: https://dl.yourcompany.com or http://localhost:3000
APP_URL=http://localhost:3000

# TRUST_PROXY: Required if running behind Nginx, Cloudflare, or Docker Traefik.
# Allows rate limiting to see the real client IP.
# Values: 'loopback', 'linklocal', 'uniquelocal', or specific IP subnets.
TRUST_PROXY=loopback

# CORRELATION_HEADER: HTTP header used for request tracing logs.
CORRELATION_HEADER=x-correlation-id

# ==============================================================================
# üóÑÔ∏è DATABASE CONFIGURATION
# ==============================================================================
# You can choose between SQLite (Default), MySQL, or PostgreSQL.

# OPTION 1: SQLite (Zero Config - Recommended for simple setups)
# ------------------------------------------------------------------------------
DB_CLIENT=sqlite
# No other DB_ vars are needed. Data is stored in /data/database.db

# OPTION 2: PostgreSQL
# ------------------------------------------------------------------------------
# DB_CLIENT=pg
# DB_HOST=127.0.0.1
# DB_PORT=5432
# DB_USER=postgres
# DB_PASSWORD=secretpassword
# DB_NAME=tempdownloads
# DB_SSL_REJECT_UNAUTHORIZED=true  # Set to false only for self-signed certs (NOT recommended)

# OPTION 3: MySQL
# ------------------------------------------------------------------------------
# DB_CLIENT=mysql
# DB_HOST=127.0.0.1
# DB_PORT=3306
# DB_USER=root
# DB_PASSWORD=secretpassword
# DB_NAME=tempdownloads
# DB_SSL_REJECT_UNAUTHORIZED=true  # Set to false only for self-signed certs (NOT recommended)

# ==============================================================================
# üöÄ JOB QUEUE & BACKGROUND PROCESSING (BullMQ)
# ==============================================================================
# Enable persistent job queue for reliable burn-on-read and background tasks.
# Requires Redis for distributed job processing and persistence.
#
# Benefits:
# - Jobs survive server restarts (persistent storage)
# - Reliable retry logic with exponential backoff
# - Multi-server support (horizontal scaling)
# - Job monitoring and observability
#
# If disabled, falls back to in-memory queue (jobs lost on restart)

# BULLMQ_ENABLED: Enable BullMQ for production reliability
# Set to 'true' for production, 'false' for development/testing
BULLMQ_ENABLED=false

# REDIS Configuration (required if BULLMQ_ENABLED=true)
# Redis is used as the job queue backend
REDIS_HOST=localhost
REDIS_PORT=6379
# REDIS_PASSWORD=your_redis_password_here
REDIS_DB=1  # Use DB 1 for job queue (DB 0 typically used for caching)

# ==============================================================================
# üîê SECURITY & CRYPTOGRAPHY
# ==============================================================================

# SESSION_SECRET: Used to sign session cookies. Must be long and random.
# Generate: openssl rand -hex 32
SESSION_SECRET=change_me_to_a_long_random_string_at_least_32_chars

# ENCRYPTION_KEYS: Used for AES-256-GCM encryption of local files and download tokens.
# Format: 64-character HEX string (recommended) OR 32-character raw string.
# Rotation: You can provide multiple keys separated by commas (e.g., NEW_KEY,OLD_KEY).
# The first key is used for encryption; all keys are tried for decryption.
# Generate: openssl rand -hex 32
ENCRYPTION_KEYS=a1b2c3d4e5f678901234567890abcdef1234567890abcdef1234567890abcdef

# ENCRYPTION_IV: Initialization Vector. MUST be exactly 16 characters long.
# This acts as the salt/seed for the encryption engine.
# Example: 1234567890123456
ENCRYPTION_IV=1234567890123456

# ==============================================================================
# üíæ STORAGE CONFIGURATION
# ==============================================================================
# STORAGE_PROVIDER Options: 'local', 's3', 'azure'
STORAGE_PROVIDER=local

# --- OPTION A: LOCAL FILESYSTEM ---
# No extra config needed. Files are stored in ./uploads/
# Ensure the directory is writable if running in Docker.

# --- OPTION B: AWS S3 / CLOUDFLARE R2 / MINIO ---
# Required if STORAGE_PROVIDER=s3
# AWS_ACCESS_KEY_ID=your_access_key
# AWS_SECRET_ACCESS_KEY=your_secret_key
# AWS_REGION=auto
# AWS_BUCKET_NAME=your-bucket-name
# AWS_ENDPOINT=https://<accountid>.r2.cloudflarestorage.com  # Leave empty for AWS S3

# --- OPTION C: AZURE BLOB STORAGE ---
# Required if STORAGE_PROVIDER=azure
# AZURE_STORAGE_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=...
# AZURE_CONTAINER_NAME=downloads

# ==============================================================================
# üå± INITIAL SEEDING
# ==============================================================================
# These credentials are ONLY used the very first time the server starts
# to create the initial Super Admin account if the database is empty.
ADMIN_INITIAL_USERNAME=admin
ADMIN_INITIAL_PASSWORD=changeme123

# ==============================================================================
# ‚öôÔ∏è OPERATIONAL SETTINGS
# ==============================================================================

# TRASH_RETENTION_DAYS: How long deleted files stay in Trash before permanent purge.
TRASH_RETENTION_DAYS=7

# RATE_LIMIT_WINDOW_MINUTES: Time window for login attempts.
RATE_LIMIT_WINDOW_MINUTES=15

# RATE_LIMIT_MAX_REQUESTS: Max login attempts allowed per IP in the window.
RATE_LIMIT_MAX_REQUESTS=100

# LOG_TO_CONSOLE: Print emoji-logs to stdout (Good for Dev/Docker).
LOG_TO_CONSOLE=true

# LOG_TO_FILE: Write JSON logs to /logs/app.log (Good for Production auditing).
LOG_TO_FILE=false
